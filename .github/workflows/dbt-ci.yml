      - name: Create dbt profiles.yml
        shell: pwsh
        run: |
          New-Item -ItemType Directory -Force -Path ci_profiles | Out-Null

          $content = @'
          empower_project:
            target: dev
            outputs:
              dev:
                type: synapse
                driver: ODBC Driver 18 for SQL Server
                server: eb-outdoorlightingperspective-workspace.sql.azuresynapse.net
                port: 1433
                database: OLP
                schema: DBT_SL
                encrypt: true
                trust_cert: true
                threads: 1
                authentication: ActiveDirectoryServicePrincipal
                client_id: ${{ secrets.AZURE_CLIENT_ID }}
                client_secret: ${{ secrets.AZURE_CLIENT_SECRET }}
                tenant_id: ${{ secrets.AZURE_TENANT_ID }}
          '@

          $content | Out-File -FilePath ci_profiles/profiles.yml -Encoding utf8
